const GAME_SCALE=6,GAME_VIRTUAL_WIDTH=1080,GAME_VIRTUAL_HEIGHT=1728,GAME_WIDTH=180,GAME_HEIGHT=288,GAME_REAL_WIDTH=180,GAME_REAL_HEIGHT=288;let RENDERER,WEBCOMPONENT,STAGE,CONTAINER,audioManager,g_localAdvStorage,vs,offline_mode=!1,xk={show_fps:!1,resize_callbacks:{},res_list:{},zorder:{}};function devp(){return vs.get("GBODYDEV")}function dlog(e,t){if(t){let e=[];return g_localAdvStorage.set("dlog",e),e}let i=g_localAdvStorage.get("dlog");return i||(g_localAdvStorage.set("dlog",[]),i=g_localAdvStorage.get("dlog")),e&&i.push(e),g_localAdvStorage.set("dlog",i),i}function play_audio(e){play_audio.granted||(play_audio.granted=!0,audioManager.grant_permission()),audioManager.play(e)}function top_area_height(){return.1*$pxi.ccc(1728)}function performace_stat(){let e=new Stats;document.body.appendChild(e.dom),requestAnimationFrame((function t(){e.update(),requestAnimationFrame(t)}))}function main(){if(xk.show_fps&&performace_stat(),install_jquery_easing(jQuery),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];let n=t.first,o=t.second,a=new PIXI.Graphics;t.parent.addChild(a),a.position.set(0,0),a.lineStyle(6,t.color).moveTo(n.x,n.y).lineTo(o.x,o.y),t.node=a};e.prototype={},this.TestLine=e}.call(this),(()=>{let e=$pxi.create_screen({width:180,height:288,screen_bgcolor:"#000",body_bgcolor:"#000",client_kind:client_kind,fps_monitor:!1});g_localAdvStorage=e.g_localAdvStorage,vs=e.vs,STAGE=e.stage,RENDERER=e.renderer,WEBCOMPONENT=$wcm.container(),CONTAINER=function(){let e={};function t(t){if(void 0===e[t]){let i=new PIXI.Container;i.x=0,i.y=0,STAGE.addChild(i),i.containerName=t,e[t]=i}return e[t]}return{view:t,visible:function(e){t(e).visible=!0},invisible:function(e){t(e).visible=!1}}}()})(),is_first_execute_of_update_for_android()){if(5===Number(opt_val(cliver))){for(let e=0,t=localStorage.length;e<t;e++){let t=localStorage.key(e);g_localAdvStorage.set(t,JSON.parse(localStorage.getItem(t)))}localStorage.clear()}}function e(e,t,i){let n=0,o=Object.keys(e);0!==o.length?o.forEach(e=>{let a=offline_resource_path+t+"/"+e+".js";($pxx.common.is_ios_hybrid_app()||$pxx.common.is_android_hybrid_app())&&(a=ios_res_path+e+".js");let l=document.createElement("script");l.onload=function(){n++,n===o.length&&i()},document.head.appendChild(l),l.src=a}):i()}(async()=>{await new Promise(t=>e(audio_resources,"audiojs",t)),await new Promise(t=>e(image_resources,"imgjs",t)),Object.keys(audio_resources).forEach(e=>{audio_resources[e]={base64:audio_resources[e]}}),await new Promise(e=>{audioManager=new AudioManager(audio_resources,e)}),$pxx.common.load_resource(image_resources,xk.res_list,(function(){xk.blueGroup=new PIXI.display.Group(1,!0),STAGE.addChild(new PIXI.display.Layer(xk.blueGroup)),xk.stgs=new GameStages({raw:get_stages()}),(async()=>{if(!get_userid())try{let e=await get_user_id();g_localAdvStorage.set("userid",e.id)}catch(e){}client_kind,$("#loading_screen").remove(),"iok"===client_kind||"// :: OSKIND :: //"===client_kind?(fetch("https://cdn.jsdelivr.net/gh/kstost/RES/appstore_playstore_banner.json").then(e=>e.json()).then(e=>{link_banner.ios.img=e.ios,link_banner.android.img=e.android;let t=.1*window.innerHeight,i=$("<div />").attr("class","downloadgra").appendTo($("body")).css({position:"fixed",bottom:0,"z-index":100,height:t,width:"100%"});function n({img:e,link:n}){$("<img />").attr("src",e).appendTo(i).css({height:.8*t,cursor:"pointer","margin-top":.1*t,"margin-left":.1*t}).on("click",e=>{location.href=n})}"pc"===$pxx.checkUserAgent()?(n(link_banner.ios),n(link_banner.android)):n(link_banner[$pxx.checkUserAgent()]),$("<img />").attr("src",e.close).appendTo(i).css({height:.4*t,position:"absolute",top:.3*t,right:.3*t}).on("click",e=>{i.on("transitionend",e=>{i.remove()}),i.css({bottom:-t,transition:"0.3s"})})}),(()=>{let e=[65,87,87,46,75,82].map(e=>String.fromCharCode(e)).join("").toLocaleLowerCase();return"file:"===location.protocol||(location[[72,79,83,84].map(e=>String.fromCharCode(e)).join("").toLowerCase()]===e||void 0)})()&&ext_logic(STAGE,180,288)):ext_logic(STAGE,180,288)})(),$(window).on("selectstart",(function(){return!1})),$(window).on("resize",(function(){Object.keys(xk.resize_callbacks).forEach(e=>{xk.resize_callbacks[e]()}),$wcm.renderer_size=null,WEBCOMPONENT.fit()}))}))})()}function fit_fontsize_to_pixel_scale(e,t,i){let n,o,a,l,r=e instanceof PixiText;if(!r){if(!fit_fontsize_to_pixel_scale.virtual_mother){fit_fontsize_to_pixel_scale.virtual_mother=document.createElement("div");let e=fit_fontsize_to_pixel_scale.virtual_mother;e.style.position="fixed",e.style.top="0px",e.style.left="0px",e.style.width="10000000px",e.style.height="10000000px"}let t=fit_fontsize_to_pixel_scale.virtual_mother;document.body.appendChild(t),l=e.style.display,e.style.display="inline-block",n=e.parentElement,o=e.previousSibling,a=e.nextSibling,t.appendChild(e)}let s=i?function(e){if(r)return e.node.width;let t=e.offsetWidth,i=getComputedStyle(e);return t+=parseInt(i.marginLeft)+parseInt(i.marginRight),t}:function(e){if(r)return e.node.height;let t=e.offsetHeight,i=getComputedStyle(e);return t+=parseInt(i.marginTop)+parseInt(i.marginBottom),t},c=null;c=r?t=>e.size=t:t=>e.style.fontSize=t+h;let d=e=>_[_.length-e],h="em",g=0,_=[],u=t/2;for(r||(u=Math.round(u)),c(u),_[_.length]=s(e);;){let i=d(1);if(i===t)break;if(u*=t/i,c(u),_[_.length]=s(e),d(1)<t&&_.length>=4){if(d(1)===d(3)&&d(2)===d(4)&&d(1)!==d(2))break}else if(_.length>=3&&d(1)===d(2)&&d(2)===d(3))break;if(g++,g>10)break}let p={fontSize:r?e.size:e.style.fontSize,number:u,element_pixel:d(1)};if(!r&&n){e.style.display=l;let t=e.parentElement;if(t.parentElement.removeChild(t),o||a){o?(m=e,(f=o).parentNode.insertBefore(m,f.nextSibling)):function(e,t){t.parentNode.insertBefore(e,t)}(e,a)}else n.appendChild(e)}var m,f;return p}function code_test(e){gen_stage_number(3),gen_stage_view(e)}function get_page_row_col(){return{y:4,x:3}}function compare_two_point(e,t){let i=e.movecnt*e.blockcnt/(t.movecnt*t.blockcnt),n=Math.round(3*i);return n>3&&(n=3),0==n&&(n=1),{stars:n,accup:i}}function calc_current_point(e,t){let i,n=-1,o=xk.stgs.get_stage_data(t).data.detail;if("number"==typeof e)i=e;else if(e){let t=compare_two_point(o,e);i=t.stars,n=t.accup}else i=0;return{stars:i,accup:n}}function convertToDegrees(e){return e*(180/Math.PI)}function scale_mod_polygon(e,t,i){return e.map(e=>({x:t.x+e.x*i,y:t.y+e.y*i}))}function set_circle_pos(e,t,i){let n=get_circle(e);n&&(n.position.x=t,n.position.y=i,set_line_pos(n))}function get_circle(e){let t=null;for(let i=0;i<xk.circle_list.length;i++)xk.circle_list[i].idx===e&&(t=xk.circle_list[i]);return t}function trans_direction(e,t){let i=180+convertToDegrees(ksttool.math.get_angle_in_radian_between_two_points(e,t)),n=-1;return n=135<i&&225>i?2:45<i&&135>i?1:225<i&&315>i?3:0,n}function refer_to_object_by_multiple_keys(e,t,i){let n=e;if(!i){for(let e=0;e<t.length&&(n=n[t[e]],void 0!==n);e++);return n}for(let e=0;e<t.length;e++)e+1===t.length?n[t[e]]=i:(n[t[e]]||(n[t[e]]={}),n=n[t[e]])}function get_number_of_cases(e,t){let i={},n=null;for(let o=0;o<t.length;o++)for(let a=0;a<t.length;a++){let l=t[o],r=t[a];if(l!==r){if(e){let e=r,t=l;l<r&&(e=l,t=r),l=e,r=t}let t=[l,r];void 0===refer_to_object_by_multiple_keys(i,t)&&(refer_to_object_by_multiple_keys(i,t,!0),n||(n=[]),n[n.length]=t)}}return n}function perm_counter(){let e="perm_counter_value",t=g_localAdvStorage.get(e);return null===t&&(t=0,g_localAdvStorage.set(e,t)),t=g_localAdvStorage.get(e)+1,g_localAdvStorage.set(e,t),t}function create_button(e){return $("<div>").html(e.label).css({display:"inline-block",background:e.color,"border-radius":10,cursor:"pointer",padding:10}).on("click",e.click)}function onKeyBack(){simple_dialog({id:"asking_exit",qr:"게임 이제 그만합니까?",btns:[{label:"그래",color:"blue",click:function(){window.WVBridge.termination(""),this.remove()}},{label:"아니다",color:"blue",click:function(){this.remove()}}]})}function gen_judge_function(e){return function(){let t=0;return e.forEach(e=>{t+=clear_judge_functions[e].method()?1:0}),t===e.length&&t>0}}function simple_dialog(e){let t=new DocuContainer({id:e.id+"dialog",bgcolor:"#000"});t.setsize($pxi.get_canvas_size().width/1.5,0),t.html(`\n          <div id='${e.id}window' style="background: ;">\n            <div>${e.qr}</div>\n          </div>\n      `);let i=$("#"+e.id+"window");i.css({"text-align":"center"});let n=$("<div>").appendTo(i).css({"text-align":"center"}),o=[];return e.btns.forEach(e=>{e.click&&(e.click=e.click.bind(t),o[o.length]=create_button(e).appendTo(n))}),o.forEach(e=>{$(e).css({"margin-left":5,"margin-right":5,"margin-bottom":10,"margin-top":10})}),t.fit_and_center($pxi.get_canvas_size().width/10),t}function generate_random_string(e){for(var t="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=i.length,o=0;o<e;o++)t+=i.charAt(Math.floor(Math.random()*n));return t}function get_user_id(){return new Promise((e,t)=>{let i={};get_userid()&&(i.id=get_userid()),$network.call("idexistcheck",i,{success:function(t){e(t)},error:function(){t()},complete:function(){}})})}function get_userid(){let e=g_localAdvStorage.get("userid");return e||(e=""),e}function is_first_execute_of_update_for_android(){if("android"===client_kind&&opt_val(cliver)){let e=g_localAdvStorage.get("executed_version");if(!e||e!==cliver)return g_localAdvStorage.set("executed_version",cliver),!0}return!1}function opt_val(e){return 0===e.indexOf("// :: ")?"":e}(function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t.transitioning=!1,t.subs={},t.node={shadow:$(document.createElement("div")).css({position:"absolute",background:"#000",opacity:.5}),body:$(document.createElement("div")).css({position:"absolute",opacity:1})},t.xk.resize_callbacks.container_resizer=function(){let e=$($pxi.get_canvas()),i=e.offset(),n={color:"#fff",top:i.top,left:i.left,width:e.outerWidth(!0),height:e.outerHeight(!0)};Object.keys(t.node).forEach(e=>{t.node[e].css(n)})},Object.keys(t.node).forEach(e=>{$("body").append(t.node[e])}),t.xk.resize_callbacks.container_resizer(),this.visible(!1,!0),this.html("")};e.prototype={html:function(e){this.node.body.html(""),this.node.body.append(e)},container:function(){return this.node.body},size:function(){let e=this.container();return{width:e.outerWidth(),height:e.outerHeight()}},getSub:function(e){return this.subs[e]},addSub:function(e,t,i){let n=this,o=!n.getSub(e)||i;return o&&n.addSubContainer(t,e),{mother:n.getSub(e),need_draw:o}},addSubContainer:function(e,t){let i=this;i.subs[t]&&i.subs[t].remove();let n=$(document.createElement("div")).attr({id:t}).html(e).appendTo(this.container());i.subs[t]=n},showWindow:function(e,t,i,n,o){let a=this;if(!a.transitioning){o||stage_show_and_hide(!e,!1,t),i&&e&&(Object.keys(a.subs).forEach(e=>{let t=a.getSub(e);t&&t.css({display:"none"})}),a.getSub(i).css({display:""})),a.transitioning=!a.transitioning;let l=0,r=function(t){l++,Object.keys(a.node).length===l&&(delete a.transitioning,e||a.visible(e,!0),n&&n.length&&n[n.length-1](e))};e&&a.visible(e,!1),n&&n.length&&n[0](e),Object.keys(a.node).forEach(i=>{a.node[i].css({"z-index":"shadow"===i?1e4:10001}),a.node[i].animate({opacity:e?"shadow"===i?a.max_opacity:1:0},t,()=>{r(i)})})}},visible:function(e,t){let i=this;Object.keys(i.node).forEach(n=>{i.node[n].css({display:e?"":"none"}),t&&i.node[n].css({opacity:e?i.max_opacity:0})})}},this.WebContainer=e}).call(this),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t.color=t.color?t.color:16777215,this.node=new PIXI.Graphics,this.node.beginFill(t.color),this.node.drawCircle(0,0,t.radius),this.node.endFill(),this.setPosition(t),t.parent.addChild(this.node)};e.prototype={remove:function(){this.node.parent.removeChild(this.node)},setPosition:function(e){return void 0!==e.x&&(this.node.position.x=e.x),void 0!==e.y&&(this.node.position.y=e.y),this}},this.CircleGraphic=e}.call(this),function(){let e=function(e){let t=this;for(var i in e)t[i]=e[i];let n=t.img;t.node=new PIXI.TilingSprite(n.texture,n.width,n.height),this.scale=1};e.prototype={set x(e){this.node.x=e},set y(e){this.node.y=e},set width(e){this.node.width=6*e},set height(e){this.node.height=6*e},get x(){return this.node.x},get y(){return this.node.y},get width(){return this.node.width},get height(){return this.node.height},set scale(e){this.node.scale.x=1/6*e,this.node.scale.y=1/6*e},get scale(){return{x:this.node.scale.x,y:this.node.scale.y}}},this.PixiTile=e}.call(this),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t.vector||(t.vector={first:{x:0,y:0},second:{x:0,y:0}}),t.setPadding(void 0===t.padding?1:t.padding,!0),t.setColor(void 0===t.color?16777215:t.color,!0),t.line=new PixiPolygon({path:[{x:0,y:0}],parent:t.stage,surface_color:t.color,parentGroup:t.parentGroup}),t.redraw()};e.prototype={setZOrder:function(e){this.line.setZOrder(e)},getZOrder:function(){return this.line.getZOrder()},cutting_calculator:function(t,i){let n=this.trim,o=[],a=i.getVector(),l=[],r=t;Object.keys(r).forEach(e=>{for(let i=0,o=(t=r[e]).length;i<o;i++){let e=t[i];if(!Block.NOT_BLOCKS.includes(e.mother_object&&e.mother_object.getKind())&&(e instanceof Vector&&(l[l.length]=e,l[l.length-1].partOf=e),e instanceof PixiPolygon)){let t=e.getWorldPathInPLPType();for(let i=0,o=t.length;i<o;i++){let o=t[i];n&&n.first.x===o.first.x&&n.first.y===o.first.y&&n.second.x===o.second.x&&n.second.y===o.second.y||(l[l.length]=o,l[l.length-1].partOf=e)}}}});for(let e=0,t=l.length;e<t;e++){let t=ksttool.check_intersection_line_line(l[e],a,!0);t&&(o[o.length]={body:l[e],coordinate:t})}let s=ksttool.math.sort_list_by_distance(o,a.first),c=i.getLineShape();if(s.length>0){let t=e.getGRP(c,s[0].body),i=s[0].body instanceof Vector;if(t){let e=[];for(let i=0,n=t.length;i<n;i++){let n=ksttool.extract_XYX(t[i],{x:.5,y:.5});e[e.length]={coordinate:{x:n.min_x,y:n.min_y},body:t[i]}}return{vector_type:i,ss:ksttool.math.sort_list_by_distance(e,a.first)[0].body,inl:s[0].body,coordinate:s[0].coordinate}}}},vector_length:function(){return ksttool.math.get_distance_between_two_point(this.vector.first,this.vector.second)},cutting:function(e){let t=this,i=t.cutting_calculator(e,t);if(i&&i.ss){let e=ksttool.math.get_angle_in_radian_between_two_points(t.vector.first,t.vector.second),n=ksttool.math.get_angle_in_radian_between_two_points(i.inl.second,i.inl.first),o=2*Math.PI,a=2*n-e,l=a>=o?a-o:a<0?a+o:a,r=t.vector_length()-ksttool.math.get_distance_between_two_point(t.vector.first,i.coordinate),s=ksttool.math.get_coordinate_distance_away_from_center_with_radian(r,i.coordinate,l);if(t.physically_draw(i.ss,t.color),!i.vector_type)return{surface_partof:i.inl&&i.inl.partOf,surface_vector:i.inl,reflect_vector:{first:i.coordinate,second:s},cutted_line:{first:t.vector.first,second:i.coordinate}}}},getVector:function(){return this.vector},setFirst:function(e,t){this.vector.first=e,t||this.redraw()},setSecond:function(e,t){this.vector.second=e,t||this.redraw()},setPadding:function(e,t){this.padding=e,t||this.redraw()},setColor:function(e,t){this.color=e,t||this.redraw()},getLineShape:function(){return this.lineShape},physically_draw:function(t,i){let n=this;if(n.line){if(n.trim){let i=[],o=e.getGRP(t,n.trim);if(o)for(let e=0,t=o.length;e<t;e++){let t=ksttool.extract_XYX(o[e],{x:.5,y:.5});i[i.length]={coordinate:{x:t.min_x,y:t.min_y},body:o[e]}}if(i.length){t=ksttool.math.sort_list_by_distance(i,n.vector.second)[0].body}}n.line.redraw(t,i,!0)}},redraw:function(){let e=this;if(e.line){let t=e.padding,i=e.vector.first,n=e.vector.second,o=Math.atan2(i.y-n.y,i.x-n.x),a=[],l=ksttool.math.get_coordinate_distance_away_from_center_with_radian(t,n,o),r=2*t+ksttool.math.get_distance_between_two_point(i,n);a[a.length]=ksttool.math.get_coordinate_distance_away_from_center_with_radian(t,l,o+Math.PI/2),a[a.length]=ksttool.math.get_coordinate_distance_away_from_center_with_radian(t,l,o-Math.PI/2),a[a.length]=ksttool.math.get_coordinate_distance_away_from_center_with_radian(r,a[a.length-1],o-Math.PI),a[a.length]=ksttool.math.get_coordinate_distance_away_from_center_with_radian(r,a[a.length-3],o-Math.PI),e.lineShape=a,e.physically_draw(a,e.color)}},remove:function(){this.line.node.visible=!1,e.objectPool[e.objectPool.length]=this}},e.objectPool=[],e.avoidDivideBug=function(e){return[{x:e[0].x,y:e[0].y+ksttool.math.EPSILON},{x:e[1].x,y:e[1].y}]},e.getGRP=function(t,i){let n=ksttool.divide_polygon(t,e.avoidDivideBug([i.first,i.second]));if(!n){let o=ksttool.reset_length_of_vector_from_mid(ksttool.math.INFINITY,i);n=ksttool.divide_polygon(t,e.avoidDivideBug([o.first,o.second]))}return n},e.getSleepingInstance=function(){let e=this.objectPool.length?this.objectPool.splice(0,1)[0]:null;return e&&(delete e.trim,e.line.node.visible=!0),e}.bind(e),this.PixiLine=e}.call(this),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t.color=t.color?t.color:16777215;let n=new PIXI.Graphics;t.parent.addChild(n),n.beginFill(t.color),n.drawCircle(0,0,t.radius),n.endFill(),n.position.x=t.x,n.position.y=t.y,this.node=n,t.noblink||$pxx.common.make_blink(n,10)};e.prototype={},this.TestDot=e}.call(this),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t.surface_color=t.surface_color?t.surface_color:65280,t.line_color=t.line_color?t.line_color:16767232,t.change={},t.change.path=!0,t.change.pivot=!0,t.change.degree=!0,t.change.surface_color=!0,t.change.extracted_path=!0;let n=new PIXI.Graphics;(t.stage||t.parent).addChild(n),t.node=n,t.parentGroup&&(t.node.parentGroup=t.parentGroup),t.setPivot(t.pivot_point,!0),t.setRotation(t.degree,!0),t.draw(),t.vector=!1,t.node.nodeID=$pxx.common.uniquue(),t.node.getID=function(){return t.node.nodeID}};e.prototype={init:function(){},setZOrder:function(e){this.node.zOrder=e},getZOrder:function(){return this.node.zOrder},addX:function(e,t){let i=this.path;for(let t=0,n=i.length;t<n;t++)i[t].x+=e;this.change.path=!0,t||this.draw()},addY:function(e,t){let i=this.path;for(let t=0,n=i.length;t<n;t++)i[t].y+=e;this.change.path=!0,t||this.draw()},setPath:function(e,t){let i=this,n=!1;if(e&&i.path)if(e.length===i.path.length)for(let t=0,o=e.length;t<o;t++)e[t].x===i.path[t].x&&e[t].y===i.path[t].y||(n=!0);else n=!0;e&&!i.path&&(n=!0),n&&(i.change.path=!0),i.path=e,i.path=i.path?i.path:[],t||i.draw()},setPivot:function(e,t){let i=this,n=!1;i.pivot_point&&e&&(i.pivot_point.x===e.x&&i.pivot_point.y===e.y||(n=!0)),!i.pivot_point&&e&&(n=!0),n&&(i.change.pivot=!0),i.pivot_point=e,i.pivot_point=i.pivot_point?i.pivot_point:{x:.5,y:.5},t||i.draw()},setRotation:function(e,t){let i=this;i.degree!==e&&(i.change.degree=!0),i.degree=e,i.degree=i.degree?i.degree:0,t||i.draw()},setColor:function(e,t){let i=this;i.surface_color!==e&&(i.change.surface_color=!0),i.surface_color=e,i.surface_color=i.surface_color?i.surface_color:16777215,t||i.draw()},draw:function(){let e=this;e.redraw(e.path,e.surface_color,!0)},redraw:function(e,t,i){let n=this;if(n.setPath(e,!0),n.setColor(t,!0),(n.change.pivot||n.change.path)&&(n.extracted_path=ksttool.extract_XYX(n.path,n.pivot_point),n.change.extracted_path=!0),n.change.degree||n.change.extracted_path){n.nls=[];let e={x:n.extracted_path.min_x,y:n.extracted_path.min_y};for(let t=0,i=n.path.length;t<i;t++){let i=ksttool.math.rotation_coordinate(e,n.path[t],n.degree);i.x-=n.extracted_path.min_x,i.y-=n.extracted_path.min_y,n.nls[n.nls.length]=i}}if(n.change.surface_color||n.change.extracted_path||n.change.degree||n.change.extracted_path||i){n.node.clear(),n.node.beginFill(t),n.node.lineStyle(0,n.line_color,0),n.node.moveTo(n.nls[0].x,n.nls[0].y);for(let e=1;e<n.nls.length;e++)n.node.lineTo(n.nls[e].x,n.nls[e].y);i&&n.node.position.set(n.extracted_path.min_x,n.extracted_path.min_y),n.node.closePath(),n.node.endFill()}n.change.path=!1,n.change.pivot=!1,n.change.degree=!1,n.change.surface_color=!1,n.change.extracted_path=!1},getWorldPathInPLPType:function(){let e=this,t=e.degree*(2*Math.PI)/360;let i=null,n={x:e.extracted_path.min_x,y:e.extracted_path.min_y},o=[];return e.path.forEach(e=>{let i=ksttool.math.rotation_coordinate(n,{x:e.x,y:e.y},ksttool.math.convert_radian_to_degrees(t),!1);o[o.length]=i}),i=ksttool.convert_XYX_to_PLP(o),e.pathCache={rotation:t,path:i},i},is_vector:function(){return this.vector},getNode:function(){return this.node}},this.PixiPolygon=e}.call(this),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t._width_limit=0;let n=t.style?t.style:{fontFamily:e.fontFamily,fontSize:10,fill:"white",stroke:"#000000",strokeThickness:10,dropShadow:!0,dropShadowColor:"#ffffff",dropShadowBlur:0,dropShadowAngle:Math.PI/6,dropShadowDistance:0},o=new PIXI.Text("AVCDE");t.node=o,o.style=new PIXI.TextStyle(n),o.anchor.x=.5,o.anchor.y=.5,o.position.x=0,o.position.y=0,Object.defineProperty(t,"size",{get(){return this.node.style.fontSize/6},set(e){this.node.style.fontSize=6*e,this.fit_width_by_newline()}}),Object.defineProperty(t,"text",{get(){return this.text_raw},set(e){this.text_raw=e,this.fit_width_by_newline()}}),Object.defineProperty(t,"parent",{get(){return this.node.parent},set(e){this.parent&&this.parent.removeChild(this.node),e&&e.addChild(this.node)}}),Object.defineProperty(t,"width_limit",{get(){return this._width_limit},set(e){this._width_limit=e,this.fit_width_by_newline()}}),Object.defineProperty(t,"x",{get(){return this.getNode().x},set(e){this.getNode().x=e}}),Object.defineProperty(t,"y",{get(){return this.getNode().y},set(e){this.getNode().y=e}}),this.scale=1};e.prototype={get width(){return this.getNode().width},get height(){return this.getNode().height},set scale(e){let t=this.getNode();t.scale.x=1/6*e,t.scale.y=1/6*e},getNode:function(){return this.node},fitfit:function(e,t){return fit_fontsize_to_pixel_scale(this,e,t)},destroy:function(){let e=this.getNode();e.parent&&e.parent.removeChild(e)},fit_width_by_newline:function(){let e=this,t=e._width_limit,i=e.text_raw.split("");e.node.text="";for(let n=0,o=i.length;n<o;n++){let o=e.node.text,a=i[n];e.node.text=e.node.text+a,t>0&&t<e.node.width&&(e.node.text=o+"\n"+a)}return e}},this.PixiText=e}.call(this),function(){var e=function(t){for(var i in t)this[i]=t[i];this.padding=0,this.width=0,this.height=0;let n=document.createElement("div"),o=document.createElement("div"),a=document.createElement("div");if(a.style.padding="0px",n.style.border="0px solid black",n.style.position="relative",n.style.overflow="hidden",n.style.padding="0px",o.style.position="absolute",o.style.left="0",o.style.overflowX="hidden",o.style.overflowY="scroll",o.classList.add(e.STYLEID),n.appendChild(o),o.appendChild(a),this.outer=n,this.inner=o,this.conte=a,!document.getElementById(e.STYLEID)){let t=document.createElement("style");t.id=e.STYLEID,t.innerHTML="."+e.STYLEID+"::-webkit-scrollbar {display: none;}",document.head.appendChild(t)}};e.prototype={html:function(e){return void 0!==e?(this.conte.innerHTML=e,this):this.conte.innerHTML},remove:function(){let e=this.outer,t=this.inner,i=this.conte;return i.parentNode.removeChild(i),t.parentNode.removeChild(t),e.parentNode.removeChild(e),this},css:function(e){let t=this,i=e.padding;return void 0===i?i=this.padding:this.padding=i,i=this.padding,t.inner.style.top=i+"px",t.inner.style.left=i+"px",Object.keys(e).forEach(n=>{if("padding"!==n)if("width"===n||"height"===n){let o=e[n];this[n]=o,t.outer.style[n]=o+2*i+"px",t.conte.style[n]=o+"px"}else t.outer.style[n]=e[n],t.conte.style[n]=e[n]}),this},set_padding:function(e){return this.css({padding:e}),this.set_width(this.width),this.set_height(this.height),this},set_width:function(e){return this.css({width:e}),this},set_height:function(e){return this.css({height:e}),this},get_element:function(){return this.outer}},e.STYLEID="style_id_"+generate_random_string(128),this.ScrollContainer=e}.call(this),function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];function n(){let e=$($pxi.get_canvas()).offset(),t=new ScrollContainer;t.css({}).set_padding(0),$(t.get_element()).css({position:"absolute",opacity:1}).appendTo($(document.body));let i=$(t.conte);return i.data("cover",t),i.data("setsize",(function(e,i){t.set_width(e).set_height(i)})),i.data("setpos",(function(i,n){$(t.get_element()).css({left:e.left+i,top:e.top+n})})),i.data("setsize")($pxi.get_canvas_size().width,$pxi.get_canvas_size().height),i.data("setpos")(0,0),i}let o=function(e){function t(){let t=$("#"+e.id);t.length&&(t.data("touch_preventer").data("cover").remove(),t.data("shadow").data("cover").remove(),t.data("cover").remove())}e||(e={}),void 0===e.shadowcolor&&(e.shadowcolor="#000000"),t();let i=n().css({opacity:0}),o=n().css({background:e.shadowcolor,opacity:.8}),a=n().css({color:"#ffffff"}).attr({id:e.id});return a.data("touch_preventer",i),a.data("shadow",o),a.data("close",()=>{t()}),a}({id:t.id,shadowcolor:t.bgcolor});this.node=o,this.setPadding(0)};e.prototype={fit_and_center:function(e){let t=this,i=$(t.node).children()[0],n=$(i).outerWidth(),o=$(i).outerHeight();t.setPadding(e),t.setsize(n+2*e,o+1*e),t.setpos(($pxi.get_canvas_size().width-t.width)/2,($pxi.get_canvas_size().height-t.height)/2)},setPadding:function(e){this.padding=e,this.setsize(this.width,this.height),this.setpos(this.pos_x,this.pos_y)},html:function(e){return void 0!==e?(this.node.html(e),this):this.conte.innerHTML},remove:function(){this.node.data("close")()},setsize:function(e,t){let i=this;this.width=e,this.height=t,[this.node,this.node.data("shadow")].forEach(n=>{let o=0;this.node===n&&(o=i.padding),n.data("setsize")(e-o,t-1*o)})},setpos:function(e,t){let i=this;i.pos_x=e,i.pos_y=t,[this.node,this.node.data("shadow")].forEach(n=>{let o=0;this.node===n&&(o=i.padding/2),n.data("setpos")(e+o,t+1*o)})}},this.DocuContainer=e}.call(this),function(){this.next=e=>({next:e}),this.error=e=>({error:e}),this.liar=function(e,t){if(e instanceof Function)return new Promise((function(i,n){let o={next:i,error:n};void 0!==t&&(o.value=t),e(o)}));{let t;e.forEach(e=>{let i=Object.keys(e)[0],n=e[i];t=t?t[i](n):liar(n)})}},[{next:"then"},{error:"catch"}].forEach(e=>{let t=Object.keys(e)[0];if(!Promise.prototype[t]){let i=e[t];Promise.prototype[t]=function(e){return this[i](t=>liar(e,t))}}})}.call(this),function(){var e=function(e){for(var t in e)this[t]=e[t];this.assign_data()};e.prototype={assign_data:function(){let e=[];this.raw.forEach(t=>{e.push({json:t})}),this.game_stages=[{json:null,clear_logic:()=>!(get_targets_status().off||get_targets_status().wrong)}].concat(e),this.parse_json(),this.translate_judge_function(),this.load_cache()},translate_judge_function:function(){this.game_stages.forEach(e=>{let t=e.data;t&&t.judge_conditions&&(e.clear_logic=gen_judge_function(t.judge_conditions))})},parse_json:function(){this.game_stages.forEach(e=>{let t=e.json;"string"==typeof t&&(t=JSON.parse(t)),e.data=t,delete e.json})},load_cache:function(){let e=this;this.game_stages.forEach(t=>{t.data&&e.get_stage_data(t.data.uxid)})},number_key_trans:function(e){if("string"!=typeof e){let t=this.get_stage_data(e);return void 0===t?t:t.data.uxid}{let t=this.pointer_cache[e];if(t)return t.no}},get_stage_data:function(e,t){function i(e){return t&&(e={data:JSON.stringify(e.data),clear_logic:e.clear_logic}),e}if("string"!=typeof e){let t=e;return i(this.game_stages[t])}{void 0===this.pointer_cache&&(this.pointer_cache={});let t=this.pointer_cache[e];if(t)return i(t.body);for(let t=0;t<this.game_stages.length;t++)if(this.game_stages[t].data&&this.game_stages[t].data.uxid===e)return this.pointer_cache[e]={body:this.game_stages[t],no:t},i(this.game_stages[t])}},replace_stage_info:function(e,t){this.get_stage_data(e).data=t},update_judge_numbers:function(e,t,i){let n=this.get_stage_data(e);if(n){let o=n.data;o.detail&&(o.detail.movecnt=t,o.detail.blockcnt=i),xk.stgs.replace_stage_info(e,o)}},affect_highest_points:function(e){if(e||(e=g_localAdvStorage.get("highest_point_list")),e){g_localAdvStorage.set("highest_point_list",e);let t=this;e&&Object.keys(e).forEach(i=>{t.update_judge_numbers(i,e[i].movecnt,e[i].blockcnt)})}},get_stage_length:function(){return this.game_stages.length},stringify:function(){var e="",t=0;this.game_stages.forEach(i=>{if(i.data){let n="STAGE "+ ++t,o=i.data;o.detail.description=n,e+="   /*"+n+"*/'"+JSON.stringify(o)+"',\n"}}),console.log(e)}},this.GameStages=e}.call(this),function(){var e=function(e){for(var t in e)this[t]=e[t];this.log_list={},this.cnt=0};e.prototype={log:function(e,t){let i=this;i.cnt++;let n="log"+i.cnt,o=document.createElement("div");o.addEventListener("click",(function(e){Object.keys(i.log_list).forEach(e=>{let t=i.log_list[e];t.parentNode.removeChild(t),delete i.log_list[e]})}),!1);let a={fontSize:"5px",position:"absolute",top:"0px",left:20*t+"px",padding:"0px",background:"black",color:"white",zIndex:1e9};Object.keys(a).forEach(e=>{o.style[e]=a[e]}),o.innerText=e+"",document.body.appendChild(o);let l=(s=(r=o).offsetHeight,c=getComputedStyle(r),s+=parseInt(c.marginTop)+parseInt(c.marginBottom));var r,s,c;let d=l/10;Object.keys(i.log_list).forEach(e=>{let t=i.log_list[e],n=Number(t.style.top.split("p")[0]);t.style.top=n+l+d+"px"}),i.log_list[n]=o}},this.SimpleLog=e}.call(this);let llog=new SimpleLog;function get_mission_text(e,t){let i=xk.stgs.get_stage_data(e).data.judge_conditions,n=locale_code;t&&(n=t);let o=[];for(let e=0;e<mission_text_generation.length;e++){let t=mission_text_generation[e].key,n=0;for(let e=0;e<t.length;e++)n+=i.includes(t[e])?1:0;n===t.length&&(o[o.length]=mission_text_generation[e])}let a=[];return o.forEach(e=>{let t=e.desc[n];t||(t=e.desc.en),a[a.length]=t}),a}function call_stage_at_end(e,t,i){xk.cleared_views&&(xk.cleared_views=!1,(async()=>{await new Promise(e=>{$pxx.common.animation((function(n,o,a){if(t.forEach(e=>{e.alpha=1-n/o,e.filters=[new PIXI.filters.BlurFilter(n/o*32,10,1)]}),a){for(let e=0;e<i.length;e++)i[e].visible=!1;for(;t.length;){let e=t.splice(0,1)[0];e.parent.removeChild(e)}e()}}),.25)}),await new Promise(e=>{$pxx.common.animation((function(t,i,n){STAGE.alpha=1-t/i,STAGE.filters=[new PIXI.filters.BlurFilter(t/i*32,10,1)],n&&e()}),.25)}),xk.cleared_views=!1;draw_stage(1,e)||gen_stage_view()})())}function gcap(e){if(xk.captions=xk.captions?xk.captions:{0:{en:"Retry",ko:"또하기"},1:{en:"Next",ko:"다음판"}},void 0===xk.captions[e])return"";let t=xk.captions[e][locale_code];return void 0===t&&(t=xk.captions[e].en),t}function ext_logic(e){function t(e,t){CONTAINER.invisible(L.container_name),CONTAINER.visible(L.office_name),$mmb.make_account_office({avatar_resources:A,avatar_current:{hair:0,body:0,eb:4,eyes:1,nose:3,mouth:4,face:1},office_group:$pxi.get_group("OFFICELAYER"),container:$pxi.get_group("OFFICELAYER").toContainer(),step:4,end_callback_before:e=>{CONTAINER.visible(L.container_name)},end_callback_after:n=>{CONTAINER.invisible(L.office_name),n&&i(e,t)}})}function i(e,t){(async()=>{await $mmb.api.checklogin()?e():t(e,t)})()}function n(){let e=!1,n=!1,o=[];let a=S(),l=$pxi.image_sprite(xk.res_list.plus);l.y=a.element.y+a.element.height/2+a.element.height/6,CONTAINER.view(L.container_name).addChild(l),l.zOrder=3,l.parentGroup=$pxi.get_group("MENULAYER"),l.interactive=!0,l.mousedown=l.touchstart=function(s){function c(){commonutil.animation((t,i,n)=>{e||(r.alpha=l.alpha=1-t,i&&(r.visible=l.visible=!1))},200,constvalue.easing.linear);let t=a.getValue(),i=10;(async()=>{for(;!n&&(e||(i--,i>0&&o.push(v()),await commonutil.delay(100)),!e););})(),commonutil.animation((i,l,r)=>{e||(a.setValue(t-Math.round(t*i),!0),l&&(a.setValue(0,!0),n=!0,o.forEach(e=>{e.reserve_kill()}),setTimeout((function(){_(()=>{},"d셋")}),1e3)))},1e3,constvalue.easing.linear)}i(()=>{$network.call("plusgold",{point:Number(a.getValue())},{success:function(e){console.log(e)},error:function(){},complete:function(){c()}})},(e,i)=>{let n=[{name:"점수포기",exe:e=>{o.remove()}},{name:"로그인&획득",exe:n=>{o.remove(),t(e,i)}}],o=$cpn.dialogbox({...$cpn.dialogbox(),parent:CONTAINER.view(L.container_name),group:$pxi.get_group("ASKINGSAVEGOLD"),list:n,text:"점수 획득하려면 로그인이 필요해요"})})};let r=$pxi.image_sprite(xk.res_list.green_arrow);r.zOrder=2;let s=l.height/2.5;r.y=a.element.y+a.element.height/2+a.element.height/6+s;let c=r.y;CONTAINER.view(L.container_name).addChild(r),r.zOrder=2,r.parentGroup=$pxi.get_group("MENULAYER"),function t(){e||animation.moveTo(r,[{y:c},{y:c+s}],()=>{setTimeout(t)},500,constvalue.easing.easeOutQuad)}();let d=$pxi.image_sprite(xk.res_list.box);d.y=a.element.y+a.element.height/2+a.element.height/6,d.y+=$pxi.ccc(1728)/8,CONTAINER.view(L.container_name).addChild(d),d.zOrder=6,d.parentGroup=$pxi.get_group("MENULAYER"),vs.set("box_sp",d);let h=!1,g=!1;function _(t,i){function o(){t(),g||(g=!0)}h?o():(h=!0,commonutil.animation((t,i,a)=>{u(1-t),i&&(d.parent.removeChild(d),r.parent.removeChild(r),l.parent.removeChild(l),vs.set("box_sp",null),e=!0,n=!0,o())},300,constvalue.easing.linear))}function u(e){d.alpha=e,r.alpha=e,l.alpha=e}return u(0),commonutil.animation((e,t,i)=>{u(e)},300,constvalue.easing.linear),{destroy:_}}function o(){return ksttool.math.generate_random_value(0,100)>95?function(){let e=ksttool.math.generate_random_value(0,99),t="";return Object.keys(P).every(i=>{let n=P[i].posibility;return!(n[0]<=e&&n[1]>e&&(t=i,1))}),t}():null}function a(e){L.realtimecheck=e,L.balls.forEach(t=>{if(e){let e=t.getUserData().velocity;e&&(delete t.getUserData().velocity,t.setDynamic(),t.setLinearVelocity(e))}else{let e=t.getLinearVelocity();t.getUserData().velocity=planck.Vec2(e.x,e.y),t.setStatic()}})}function l(e,t,i,n,o){if(i){void 0===o&&(o=t.map((e,t)=>({body:e,idx:t})));let e=O(),a=[],l={x:i.getUserData().pixi_element.x,y:i.getUserData().pixi_element.y},r=i.getUserData().pixi_element.extend_itemno;return o.forEach(t=>{let o=t.body;if(o!==i){let i={x:o.getUserData().pixi_element.x,y:o.getUserData().pixi_element.y},s=o.getUserData().pixi_element.extend_itemno,c=ksttool.math.get_distance_between_two_point(l,i);e*1.01>=c&&(0===n?s===r&&a.push(t):1===n?s!==r&&a.push(t):2===n&&a.push(t))}}),a}return[]}function r(){let e=$pxi.get_group("물결부분");{let e=$pxi.image_sprite(xk.res_list.navy);e.width=$pxi.ccc(1080),e.height=$pxi.ccc(1728),e.x=$pxi.ccc(0),e.y=$pxi.ccc(0),e.alpha=1,$pxi.addChild($pxi.get_group("동물들"),e)}R.create_element({parent_group:$pxi.get_group("동물들"),y:432-$pxi.ccc(L.bottom_height),x:90,width:1800,height:288,friction:10,color:"ffffff",mass:1}).getUserData().pixi_element.parentGroup=$pxi.get_group("물결부분");R.create_element({parent_group:$pxi.get_group("동물들"),y:144,x:270-$pxi.ccc(xk.res_list.ten2.width),width:180,height:28800,friction:10,mass:1}).getUserData().pixi_element.parentGroup=$pxi.get_group("물결부분");R.create_element({parent_group:$pxi.get_group("동물들"),y:-288,x:90,width:1800,height:288,friction:10,mass:1}).getUserData().pixi_element.parentGroup=$pxi.get_group("물결부분");R.create_element({parent_group:$pxi.get_group("동물들"),y:144,x:-90+$pxi.ccc(xk.res_list.ten2.width),width:180,height:28800,friction:10,mass:1}).getUserData().pixi_element.parentGroup=$pxi.get_group("물결부분");{let t=$pxi.image_sprite(xk.res_list.black);t.width=$pxi.ccc(1080),t.height=top_area_height(),t.x=$pxi.ccc(0),t.y=$pxi.ccc(0),t.alpha=.5,$pxi.addChild(e,t)}{let t=$pxi.image_sprite(xk.res_list.wave_black);t.x=($pxi.ccc(1080)-t.width)/2,t.y=$pxi.ccc(1728)-(t.x+$pxi.ccc(t.texture.height)),t.y=top_area_height(),t.alpha=.5,$pxi.addChild(e,t)}{let t=$pxi.image_sprite(xk.res_list.wave_white);t.x=($pxi.ccc(1080)-t.width)/2,t.y=$pxi.ccc(1728)-(t.x+$pxi.ccc(t.texture.height)),t.y=top_area_height(),vs.set("wavvv",t),$pxi.addChild(e,t)}{let t=$pxi.image_sprite(xk.res_list.threemenu);vs.set("w1avvv",t),t.y=(vs.get("wavvv").y-t.height)/2,t.x=t.y,$pxi.addChild(e,t),t.interactive=!0,t.mousedown=t.touchstart=e=>{w(!1),L.game_pause=!0;let t=[{label:"계속하기",exec:()=>{o.close()}}],i=$pxi.get_group("MENULAYER"),n=CONTAINER.view(L.container_name),o=$cpn.make_menu({bottom:$pxi.ccc(0),menu:t,group:i,parent:n,close_default_event:()=>{w(!0),L.game_pause=!1}})}}{let e=function(e){void 0===e&&(e=$pxi.get_group("물결부분"));let t=0,i=new PixiText({fontFamily:"jalnan"}),n=i.getNode();n.interactive=!0,n.mousedown=n.touchstart=function(e){L.gameplaying},i.text="",i.size=$pxi.ccc(80),i.scale=1,n.zOrder=1,$pxi.addChild(e,i);let o=new PixiText({fontFamily:"NEXON-Lv1-Gothic-Light"});o.getNode().zOrder=110,o.text="다음목표",o.size=$pxi.ccc(30),$pxi.addChild(e,o);let a=new PixiText({fontFamily:"NEXON-Lv1-Gothic-Bold"});function l(e,a){let l=vs.get("gold_icon");t=e,i.text=String(e);let r=0;if(l&&(r=.2*l.width),n.position.y=n.height/2+(top_area_height()-n.height)/2,a){if(l){let e=n;n.position.x=e.width/2+($pxi.ccc(1080)-e.width)/2,l.position.x=($pxi.ccc(1080)-e.width)/2-(l.width+r)}}else{let e=vs.get("w1avvv");n.position.x=e.x+e.width+e.x/2+n.width/2,l&&(n.position.x+=l.width+r)}o.x=o.width/2+i.x-i.width/2,o.y=o.height/2+i.y+i.height/2*.8,g()}function r(){return t}function s(e,t){l(r()+e,t)}function c(e){let t=0;{let e=i,n=e.x,o=e.width/2+($pxi.ccc(1080)-e.width)/2;t=o-n,animation.moveTo(e,[{x:n},{x:o}],()=>{},500,constvalue.easing.easeOutQuad)}{let i=vs.get("gold_icon");animation.moveTo(i,[{x:i.x},{x:i.x+t}],e,500,constvalue.easing.easeOutQuad)}}function d(){return Number(_().value.text)}function h(e){_().value.text=String(e),g()}function g(){a.x=a.width/2+i.x-i.width/2+o.width,a.y=a.height/2+i.y+i.height/2*.8}function _(){return{title:o,value:a}}return a.getNode().zOrder=110,a.text="30201",a.size=$pxi.ccc(30),$pxi.addChild(e,a),_().title.getNode().visible=!1,_().value.getNode().visible=!1,h("112"),{element:i,getNextgoalValue:d,setNextgoalValue:h,getNextgoal:_,setValue:l,getValue:r,addValue:s,move_to_center:c}}();e.setValue(0),vs.set("plabel",e)}{let t=new PixiTile({img:xk.res_list.ten2});t.height=$pxi.ccc(1728)/1,t.y=top_area_height()+vs.get("wavvv").height+$pxi.ccc(0),$pxi.addChild(e,t)}{let t=new PixiTile({img:xk.res_list.ten2});t.height=$pxi.ccc(1728)/1,t.x=$pxi.ccc(1080)-$pxi.ccc(t.width),t.y=top_area_height()+vs.get("wavvv").height+$pxi.ccc(0),$pxi.addChild(e,t)}{vs.get("w1avvv");let t=$pxi.image_sprite(xk.res_list.two_golds);t.zOrder=3,$pxi.addChild(e,t),vs.set("gold_icon",t)}s()}function s(){let e=S(),t=vs.get("w1avvv"),i=vs.get("gold_icon"),n=e.element.height,o=e.element.height*i.width/i.height;n*=.7,o*=.7,$pxi.set_sprite_size(i,o,n),i.x=t.x+t.width+t.width/3,i.y=(vs.get("wavvv").y-i.height)/2,e.addValue(0)}function c(e,t){let i=e.map((e,t)=>({body:e,idx:t})),n={},o={};function a(r,s){s.forEach(s=>{void 0===n[r]&&(n[r]={}),void 0===n[r][s.idx]&&(n[r][s.idx]=s,o[s.idx]=!0,a(r,l(0,e,s.body,t,i)))})}i.forEach(n=>{let r=n.body,s=n.idx;o[n.idx]||a(s,l(0,e,r,t,i))});let r=[];return Object.keys(n).forEach(e=>{let t=Object.keys(n[e]).map(t=>n[e][t].body);r.push(t)}),r}function d(e){e.getUserData().danger_aniproc&&(e.getUserData().danger_aniproc.stop_ani(),delete e.getUserData().danger_aniproc)}function h(){L.balls.filter(e=>e.getUserData().danger_aniproc).forEach(e=>{e.getUserData().danger_animation_time=L.danger_fulltime})}function g(e){if(!e.getUserData().danger_aniproc){e.getUserData().danger_animation_time=L.danger_fulltime;let n=50;function t(o,a){a?e.getUserData().danger_animation_time=o:(e.getUserData().danger_animation_time-=o,i()<n&&t(n,!0))}function i(){return e.getUserData().danger_animation_time}e.getUserData().danger_aniproc=function(){let n=!0,o=!0;return function a(){L.game_pause?(async()=>{await commonutil.delay(1e3/60),a()})():commonutil.animation((l,r)=>{if(o){let t=255*(n?l:1-l);e.getUserData().pixi_element.children[0].tint=$pxi.color(255,t,t)}r&&(n=!n,t(.5*i()),o&&setTimeout(a))},i(),constvalue.easing.easeOutQuad)}(),{stop_ani:function(){o=!1,e.getUserData().pixi_element.children[0].tint=$pxi.color(255,255,255)}}}()}}function _(e){let t=e?$pxi.get_group("MENULAYER"):$pxi.get_group("물결부분");$pxi.addChild(t,S().element),$pxi.addChild(t,vs.get("gold_icon"))}function u(e,t,i){e||(e=0,t=!0),L.current_level=e,L.checker_pointer.modLoop("newgen","limit",L.levels[L.current_level].gen_time);let n=()=>{t&&(S().setNextgoalValue(0),S().getNextgoal().title.getNode().visible=!0,S().getNextgoal().value.getNode().visible=!0),t&&(_(!1),s()),k(),a(!0),L.select_one=!1,L.game_pause=!1,L.gameplaying=!1,L.change_animation=!1;let n=S();t&&(n.setValue(0),L.checker_pointer.getList().forEach(e=>{L.checker_pointer.setchecker(e,0),L.checker_pointer.setactive(e,!0)})),L.linecount=$().linecount,L.excg=$().excg;let o=Math.round(100*(e+1)/L.levels[e].excg*(1+.1*(e+1)));S().setNextgoalValue(S().getValue()+o),i&&i()};vs.get("goldset")?vs.get("goldset")(n):n()}function p(e,t){let i=$pxi.get_group("ASKINGSAVEGOLD");if(t<2)return;let n=new PixiText({fontFamily:"jalnan"});n.getNode().zOrder=10,n.text=String(t),n.size=$pxi.ccc(350),n.x=n.width/2,n.y=n.height/2,n.scale=1,$pxi.addChild(i,n);let o,a,l,r,s=I("COMBO",10,i);s.x=0,s.y=n.height-$pxi.ccc(43.2),n.x+=s.width-n.width-(s.width-n.width)/2,n.width>s.width?(o=n.x-n.width,a=n.x+n.width):(o=s.x,a=s.width),r=s.y+s.height,l=0;let c=ksttool.check_intersection_line_line({first:{x:o,y:0},second:{x:a,y:r}},{first:{x:o,y:r},second:{x:a,y:0}},!0),d=e.x-c.x,h=e.y-c.y;n.x+=d,n.y+=h,s.x+=d,s.y+=h;let g=0;s.chars.forEach((e,t)=>{e.y-=e.height/2,e.getNode().alpha=0,g++,(async()=>{await commonutil.delay(100*t),await new Promise(t=>{{let i=e.y,n=e.height;commonutil.animation((o,a)=>{e.y=i+o*n,e.getNode().alpha=o,a&&t()},100)}}),await new Promise(t=>{{let i=e.y,n=e.height/2;commonutil.animation((o,a)=>{e.y=i-o*n,a&&t()},100)}}),_()})()});{let e=n;e.y-=e.height/2,e.getNode().alpha=0,(async()=>{g++,await new Promise(t=>{{let i=e.y,n=e.height;commonutil.animation((o,a)=>{e.y=i+o*n,e.getNode().alpha=o,a&&t()},100)}}),await new Promise(t=>{{let i=e.y,n=e.height/2;commonutil.animation((o,a)=>{e.y=i-o*n,a&&t()},100)}}),_()})()}function _(){g--,0===g&&(async()=>{await commonutil.delay(200),commonutil.animation((e,t)=>{n.getNode().alpha=1-e,s.chars.forEach((t,i)=>{t.getNode().alpha=1-e}),t&&(s.remove(),n.destroy())},100)})()}}function m(e){w(!0);let t=[];for(L.newtoggle=!L.newtoggle;;){let e;if(0===t.length)e=E();else for(;void 0===e||t[t.length-1]===e;)e=E();if(t.push(e),L.newtoggle){if(t.length>=C()/O())break}else if(t.length+1>=C()/O())break}let i=$pxi.ccc(xk.res_list.ten2.width);if(L.newtoggle||(i+=O()/2),void 0!==e&&t.length>e)for(e=t.length-e;t.filter(e=>null===e).length<e;){let e=ksttool.math.generate_random_value(0,t.length-1);t[e]=null}(async()=>{for(let e=0;e<t.length;e++){let n=t[e];null!==n&&N({wrd:R,parent__group:$pxi.get_group("동물들"),y:-O(),x:i+(O()/2+e*O())},n,L.balls)}})()}function f(e,t){L.combo=0;let i=vs.get("item_count_label",{}),n=vs.get("item_icon_sprite",{}),o=i[e];if(void 0===o)return;t||function(e){P[e].firecode()}(e),function(e){let t=-1;L.my_item_list.forEach((i,n)=>{i.item===e&&(t=n,i.count--)});let i=0;t>-1&&(i=L.my_item_list[t].count)}(e);let a=o.element.getNode(),l=o.getValue()-1;return o.setValue(l),l<=0&&(a.parent.removeChild(a),n[e].parent.removeChild(n[e]),delete n[e],delete i[e]),!0}function x(e,t){if(T.includes(e.getUserData().uid))return;h(),L.danger_time=0,L.balls.forEach(e=>{d(e)}),T.push(e.getUserData().uid),function(e){let t={x:R.planck_pos(e).x,y:R.planck_pos(e).y},i=2*O(),n=ksttool.math.get_point_on_arc({x:t.x,y:t.y,r:O()/2},{x:t.x+ksttool.math.generate_random_value(-i,i),y:t.y+ksttool.math.generate_random_value(-i,i)}),o=5+ksttool.math.generate_random_value(0,5),a=360/o;for(let e=0;e<o;e++){let i=ksttool.math.rotation_coordinate(t,n,a*e),o=.5,l=ksttool.math.get_coordinate_between_two_points(t,i,o);{let e=R.create_element({parent_group:$pxi.get_group("동물들"),x:l.x,y:l.y,color:"ffffff",radius:O()/2,restitution:0,friction:0,mass:0,dynamic:!1});e.getFixtureList().setSensor(!0),commonutil.animation((n,a)=>{let l=ksttool.math.get_coordinate_between_two_points(t,i,o+.5*n);R.planck_pos(e,l);let r=0;n>=.5&&(r=(n-.5)/.5),e.getUserData().pixi_element.alpha=1-r,e.getUserData().pixi_element.scale.x=.2*n,e.getUserData().pixi_element.scale.y=n,e.getUserData().pixi_element.rotation=2*Math.PI*n*10,a&&R.destroy(e)},700,constvalue.easing.easeOutQuad)}}}(e);for(let t=0;t<L.balls.length;t++)if(L.balls[t]===e){L.balls.splice(t,1);break}if(e.getUserData().item_kind&&!t){let t=e.getUserData().item_kind.item_element;t.custumdata_before_pick=!1,t.x=e.getUserData().pixi_element.x,t.y=e.getUserData().pixi_element.y,t.rotation=e.getUserData().pixi_element.rotation,CONTAINER.view(L.container_name).addChild(t),t.parentGroup=$pxi.get_group("아이템그림"),t.zOrder=1;let i={...$pxi.get_sprite_size(t),x:t.x,y:t.y},n=e.getUserData().item_kind.item_name,{order:o}=function(e){let t=-1;return L.my_item_list.forEach((i,n)=>{i.item===e&&(t=n,i.count++)}),-1===t&&(t=L.my_item_list.push({item:e,count:1})-1),{order:t,count:L.my_item_list[t].count}}(n),a=top_area_height()-$pxi.ccc(0);commonutil.animation((e,l)=>{let r=ksttool.math.get_coordinate_between_two_points(i,{x:$pxi.ccc(1080)-a/2-o*a,y:a/2},e);if(t.x=r.x,t.y=r.y,t.rotation=0,$pxi.set_sprite_size(t,a+(i.width-a)*(1-e),a+(i.width-a)*(1-e)),l){let e=vs.get("item_count_label",{}),i=vs.get("item_icon_sprite",{});if(void 0===i[n]){i[n]=t;let e=function(e,t){if(void 0===vs.get("item_count_label",{})[e]){let a=top_area_height()-$pxi.ccc(0),l=0,r=new PixiText({fontFamily:"jalnan"}),s=r.getNode();function i(e,t){l=e,r.text=String(e),o(t)}function n(){return l}function o(e){let i=r.getNode();i.x=$pxi.ccc(1080)-a+i.width/2-t*a+(a-i.width)/2,i.y=a/2}s.parentGroup=$pxi.get_group("아이템라벨"),s.zOrder=10,r.text="",r.size=$pxi.ccc(50),r.scale=1,CONTAINER.view(L.container_name).addChild(s),vs.get("item_count_label",{})[e]={element:r,set_label_pos:o,setValue:i,getValue:n,addValue:function(e,t){let o=n()+e;return i(o,t),o}}}return vs.get("item_count_label",{})[e]}(n,o),a=e.element.getNode();e.addValue(1),[a,t].forEach(e=>{e.interactive=!0,e.mousedown=e.touchstart=function(e){L.gameplaying&&!L.select_one&&f(n)}})}else{let i=e[n];t.parent.removeChild(t),i.addValue(1)}}},1e3,constvalue.easing.easeOutQuad)}t||(e.getUserData().pixi_element.children[0].texture=U[e.getUserData().ballkind].texture);let i=R.destroy(e,!0);commonutil.animation((e,t)=>{i.scale.x=1+.5*e,i.scale.y=1+.5*e,i.alpha=1-e,t&&i.parent&&i.parent.removeChild(i)},1e3,constvalue.easing.easeOutCubic)}function y(e,t){t++;let i=Math.random()*(t-e)+e;return Math.floor(i)}function v(e){let t=S();void 0===e&&(e=1);let i=$pxi.image_sprite(ksttool.math.generate_random_value(0,1)?xk.res_list.two_golds:xk.res_list.one_gold);CONTAINER.view(L.container_name).addChild(i),i.zOrder=2,i.parentGroup=$pxi.get_group("MENULAYER");let n=t.element.height,o=t.element.height*i.width/i.height;n*=e,o*=e,$pxi.set_sprite_size(i,o,n),i.x=($pxi.ccc(1080)-i.width)/2,i.y=t.element.y-t.element.height/2,i.x-=ksttool.math.generate_random_value(0,.07*$pxi.ccc(1080))*(ksttool.math.generate_random_value(0,1)?1:-1);let a=i.y;function l(){i.parent&&i.parent.removeChild(i)}!function e(){i.parent&&(i.alpha=0,commonutil.animation((e,t)=>{i.alpha=e},300,constvalue.easing.easeOutQuad),vs.get("box_sp")?animation.moveTo(i,[{y:a},{y:a+(vs.get("box_sp").y-a)+vs.get("box_sp").height/2}],()=>{r?l():setTimeout(e)},700,constvalue.easing.linear):l())}();let r=!1;return{element:i,reserve_kill:function(){r=!0}}}function b(){Object.keys(P).forEach(e=>{for(;f(e,!0););})}function k(){for(;L.balls.length;)x(L.balls[0],!0)}function w(e){e?L.select_one||a(!0):a(!1)}function $(){let e=L.levels[L.current_level];return e||(e=L.levels[L.levels.length-1]),e}function E(){let e=$().bkind;if(e){let t=e;return t[Math.floor(Math.random()*t.length)]}return y(0,j.length-1)}function N(e,t,i){let n=e.wrd;t=void 0===t?E():t,void 0===e&&(e={x:O()/2+O()*y(0,C()/O()-1),y:O()/2+O()*y(0,288/O()-1)});let a=n.create_element({parent_group:e.parent__group,x:e.x,y:e.y,radius:e.size?e.size:O(),restitution:0,friction:.1,mass:0,dynamic:!0,img:D[t]});a.setGravityScale(3),a.getUserData().pixi_element.extend_itemno=t,a.getUserData().pixi_element.interactive=!0,a.getUserData().pixi_element.mousedown=a.getUserData().pixi_element.touchstart=function(e){if(L.gameplaying&&!L.change_animation&&L.balls.includes(a))if(L.select_one)if(L.select_one===a)L.balls.forEach(e=>{e.getUserData().pixi_element.alpha=1}),L.select_one=!1,w(!0);else{if(L.balls.forEach(e=>{e.getUserData().pixi_element.alpha=1,e.getUserData().pixi_element.zOrder=1}),l(0,L.balls,L.select_one,1).map(e=>e.body).includes(a)){let e={one:n.planck_pos(L.select_one),two:n.planck_pos(a)};e.one={x:e.one.x,y:e.one.y},e.two={x:e.two.x,y:e.two.y};let t=ksttool.math.get_coordinate_between_two_points(e.one,e.two,.5),i=L.select_one;i.getUserData().pixi_element.zOrder=2,a.getUserData().pixi_element.zOrder=2,L.change_animation=!0,L.combo=0,play_audio("audio_wind"),commonutil.animation((function(o,l){n.planck_pos(i,ksttool.math.rotation_coordinate(t,e.one,180*o)),n.planck_pos(a,ksttool.math.rotation_coordinate(t,e.two,180*o)),l&&((async()=>{await commonutil.delay(constvalue.oneframe),L.select_one=!1,w(!0)})(),L.change_animation=!1)}),100)}else L.select_one=!1,w(!0)}else{w(!1),L.select_one=a;let e=l(0,L.balls,a,1).map(e=>e.body);L.balls.forEach(t=>{e.includes(t)||t===a?t.getUserData().pixi_element.alpha=t===a?.5:1:t.getUserData().pixi_element.alpha=.1})}},a.getUserData().ballkind=t;let r=o();if(r){let e=P[r].res,t=new PIXI.Sprite(e.texture),i=O()/e.width;t.position.x=0,t.position.y=0,t.scale.x=i,t.scale.y=i,t.pivot.set(e.width/2,e.width/2),a.getUserData().pixi_element.addChild(t),a.getUserData().item_kind={item_element:t,item_name:r},t.custumdata_before_pick=!0;{let e=!1;!function i(){t.custumdata_before_pick&&commonutil.animation((n,o)=>{t.alpha=e?.7*(1-n):.7*n,t.custumdata_before_pick||(t.alpha=1),o&&(e=!e,i())},500,constvalue.easing.easeInQuad)}()}}return i&&i.push(a),a}function C(){return 180-2*$pxi.ccc(xk.res_list.ten2.width)}function S(){return vs.get("plabel")}function O(){return C()/L.linecount}function I(e,t,i){let n,o,a=0,l=0,r=-$pxi.ccc(t),s=[];function c(){let e;o=0,s.forEach((t,i)=>{let n;n=e?e.x+e.width/2+t.width/2+r:t.width/2+a,t.x=n,t.y=l+t.height/2,e=t,t.height>o&&(o=t.height)}),n=s[s.length-1].x+s[s.length-1].width/2}return Array.from(e).forEach(e=>{let t=new PixiText({fontFamily:"jalnan"});t.getNode().zOrder=10,t.text=e,t.size=$pxi.ccc(100),t.x=t.width/2,t.y=t.height/2,t.scale=1,$pxi.addChild(i,t),s.push(t)}),c(),{set x(e){a=e,c()},set y(e){l=e,c()},get x(){return a},get y(){return l},height:o,width:n,remove:function(){s.forEach(e=>{e.destroy()})},chars:s}}document.body.style.background="#000";let P,T=[],A={body:[xk.res_list.body1],eb:[xk.res_list.eb1,xk.res_list.eb2,xk.res_list.eb3,xk.res_list.eb4,xk.res_list.eb5],eyes:[xk.res_list.eyes1,xk.res_list.eyes2,xk.res_list.eyes3,xk.res_list.eyes4,xk.res_list.eyes5,xk.res_list.eyes6,xk.res_list.eyes7,xk.res_list.eyes8,xk.res_list.eyes9,xk.res_list.eyes10,xk.res_list.eyes11,xk.res_list.eyes12],face:[xk.res_list.face1,xk.res_list.face2,xk.res_list.face3],hair:[xk.res_list.hair1,xk.res_list.hair2,xk.res_list.hair3,xk.res_list.hair4],mouth:[xk.res_list.mouth1,xk.res_list.mouth2,xk.res_list.mouth3,xk.res_list.mouth4,xk.res_list.mouth5,xk.res_list.mouth6,xk.res_list.mouth7,xk.res_list.mouth8,xk.res_list.mouth9],nose:[xk.res_list.nose1,xk.res_list.nose2,xk.res_list.nose3,xk.res_list.nose4,xk.res_list.nose5]},j=["d63131","fff29e","59ff64","1fd2ff","e9a6ff","FFFFFF"],D=[xk.res_list.ball1,xk.res_list.ball2,xk.res_list.ball3,xk.res_list.ball4,xk.res_list.ball5,xk.res_list.ball6],z=[xk.res_list.ball1_grey,xk.res_list.ball2_grey,xk.res_list.ball3_grey,xk.res_list.ball4_grey,xk.res_list.ball5_grey,xk.res_list.ball6_grey],U=[xk.res_list.ball1_cry,xk.res_list.ball2_cry,xk.res_list.ball3_cry,xk.res_list.ball4_cry,xk.res_list.ball5_cry,xk.res_list.ball6_cry],L={game_pause:!1,current_level:0,levels:[{linecount:2,excg:2,gen_time:50,msg:"2개로 모아주세요",bkind:[0,2,3],judge:()=>{}},{linecount:3,excg:2,gen_time:50,msg:"2개로 모아주세요",bkind:null,judge:()=>{}},{linecount:3,excg:3,gen_time:150,msg:"3개로 모아주세요",bkind:null,judge:()=>{}},{linecount:4,excg:3,gen_time:120,msg:"3개로 모아주세요",bkind:null,judge:()=>{}},{linecount:5,excg:3,gen_time:100,msg:"3개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:3,gen_time:70,msg:"3개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:4,gen_time:100,msg:"4개로 모아주세요",bkind:null,judge:()=>{}},{linecount:3,excg:4,gen_time:150,msg:"4개로 모아주세요",bkind:null,judge:()=>{}},{linecount:4,excg:4,gen_time:120,msg:"4개로 모아주세요",bkind:null,judge:()=>{}},{linecount:5,excg:4,gen_time:70,msg:"4개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:5,gen_time:100,msg:"5개로 모아주세요",bkind:null,judge:()=>{}},{linecount:3,excg:5,gen_time:100,msg:"5개로 모아주세요",bkind:null,judge:()=>{}},{linecount:4,excg:5,gen_time:100,msg:"5개로 모아주세요",bkind:null,judge:()=>{}},{linecount:5,excg:5,gen_time:100,msg:"5개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:6,gen_time:100,msg:"6개로 모아주세요",bkind:null,judge:()=>{}},{linecount:3,excg:6,gen_time:100,msg:"6개로 모아주세요",bkind:null,judge:()=>{}},{linecount:4,excg:6,gen_time:100,msg:"6개로 모아주세요",bkind:null,judge:()=>{}},{linecount:5,excg:6,gen_time:100,msg:"6개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:7,gen_time:100,msg:"7개로 모아주세요",bkind:null,judge:()=>{}},{linecount:3,excg:7,gen_time:100,msg:"7개로 모아주세요",bkind:null,judge:()=>{}},{linecount:4,excg:7,gen_time:100,msg:"7개로 모아주세요",bkind:null,judge:()=>{}},{linecount:5,excg:7,gen_time:100,msg:"7개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:8,gen_time:100,msg:"8개로 모아주세요",bkind:null,judge:()=>{}},{linecount:3,excg:8,gen_time:100,msg:"8개로 모아주세요",bkind:null,judge:()=>{}},{linecount:4,excg:8,gen_time:100,msg:"8개로 모아주세요",bkind:null,judge:()=>{}},{linecount:5,excg:8,gen_time:100,msg:"8개로 모아주세요",bkind:null,judge:()=>{}},{linecount:6,excg:9,gen_time:100,msg:"9개로 모아주세요",bkind:null,judge:()=>{}}],container_name:"game_container",office_name:"office_container",combo:0,danger_fulltime:500,timeout:180,gen_speed:55,linecount:6,excg:7,balls:[],moving:!0,my_item_list:[],bottom_height:10};$pxi.get_group("동물들",0,L.container_name),$pxi.get_group("안내텍스트",0,L.container_name),$pxi.get_group("물결부분",0,L.container_name),$pxi.get_group("아이템그림",0,L.container_name),$pxi.get_group("아이템라벨",0,L.container_name),$pxi.get_group("점수텍스트",10,L.container_name),$pxi.get_group("MENULAYER",11,L.container_name),$pxi.get_group("GAMEOVERBANNER",11,L.container_name),$pxi.get_group("OFFICELAYER",10,L.office_name),$pxi.get_group("ASKINGSAVEGOLD",10,L.container_name),P={clearall:{posibility:[0,10],res:xk.res_list.item1,desc:"다지우기",firecode:function(){let e=0,t=L.balls.map(e=>e),i=n=>{e+=n,e>=.6&&(e=0,t.length?x(t.splice(0,1)[0]):PIXI.Ticker.shared.remove(i))};PIXI.Ticker.shared.add(i)}},shake:{posibility:[35,100],res:xk.res_list.item2,desc:"흔들기",firecode:function(){$pxi.sort_list_by_object_key(L.balls.map(e=>({body:e,posy:e.getPosition().y})),"posy").reverse().splice(0,L.linecount).forEach(({body:e},t)=>{let i=R.pixipos_planckpos({x:ksttool.math.generate_random_value(-$pxi.ccc(2160),$pxi.ccc(2160)),y:ksttool.math.generate_random_value($pxi.ccc(1728),$pxi.ccc(34560))});t%2==0&&e.setLinearVelocity(planck.Vec2(i.x,-i.y))})}},clearone:{posibility:[10,35],res:xk.res_list.item3,desc:"한종 모두 지우기",firecode:function(){let e=[...new Set(L.balls.map(e=>e.getUserData().ballkind))];if(e.length){let t=e[ksttool.math.generate_random_value(0,e.length-1)],i=L.balls.filter(e=>{if(e.getUserData().ballkind===t)return e}),n=6,o=0,a=0,l=e=>{o+=e,o>=n&&(a++,o=0,i.length?x(i.splice(0,1)[0]):PIXI.Ticker.shared.remove(l))};PIXI.Ticker.shared.add(l)}}}};let R=make_world({worldScale:$pxi.ccc(60),gravity:planck.Vec2(0,20)});r(),L.checker_pointer=function(){let e={},t=[];function i(t,i){e[t]&&(e[t].time=i)}function n(t,n){if(void 0!==e[t])return e[t].active&&(e[t].time+=n,void 0===e[t].limit||0===e[t].limit||e[t].time>=e[t].limit)?(i(t,0),e[t].cb(n),!0):void 0}function o(i){delete e[i],t=Object.keys(e)}let a={setchecker:i,setactive:function(t,i){e[t]&&(e[t].active=i)},checker:n,addLoop:function(i,n){e[i]&&o(i),n.cb=n.cb.bind(n),e[i]=n,t=Object.keys(e)},remLoop:o,getList:function(){return t},modLoop:function(t,i,n){e[t][i]=n}};return PIXI.Ticker.shared.add(e=>{t&&t.forEach(t=>{n(t,e)})}),a}(),L.checker_pointer.addLoop("newgen",{time:0,active:!0,limit:L.gen_speed,cb:function(e){L.game_pause||!L.realtimecheck||L.select_one||!L.gameplaying||L.in_danger||m()}}),L.checker_pointer.addLoop("groupcheck",{time:0,active:!0,limit:0,cb:function(e){if(!L.game_pause&&L.gameplaying&&L.realtimecheck){let e=c(L.balls,0).filter(e=>{if(e.length>=L.excg)return e});e.length&&(w(!1),(async()=>{let t=t=>{e.forEach(e=>{e.forEach(e=>{e.getUserData().pixi_element.alpha=.5})})};PIXI.Ticker.shared.add(t),await commonutil.delay(110),PIXI.Ticker.shared.remove(t),e.forEach(e=>{!function(e){let t=S();L.combo++;let i=L.excg,n=e.length-L.excg;for(let e=0;e<n;e++)i+=i;let o=Math.floor(Math.pow(L.combo-1,1.05)+i);t.addValue(o);let a,l,r,s,c,d=[];e.forEach(e=>{d.push({x:e.getUserData().pixi_element.x,y:e.getUserData().pixi_element.y}),x(e)}),play_audio("audio_bom"),d.forEach(e=>{(void 0===a||a>e.x)&&(a=e.x),(void 0===l||l>e.y)&&(l=e.y),(void 0===r||r<e.x)&&(r=e.x),(void 0===s||s<e.y)&&(s=e.y)}),c=2===d.length?ksttool.math.get_coordinate_between_two_points(d[0],d[1],.5):ksttool.check_intersection_line_line({first:{x:a,y:l},second:{x:r,y:s}},{first:{x:a,y:s},second:{x:r,y:l}},!0),p(c,L.combo);let h=$().judge();void 0===h&&(h=!0),!L.clear_lock&&h&&t.getValue()>=t.getNextgoalValue()&&(L.clear_lock=!0,G(!1),u(L.current_level+1,!1,()=>{M("CLEAR",()=>{let e,t;M("NEXT",(i,n)=>{e=i,t=n},2);let i=[{name:"확인",exe:i=>{e&&(t(),o.remove(),G(!0),L.clear_lock=!1,L.combo=0)}}],n=$().msg,o=$cpn.dialogbox({...$cpn.dialogbox(),parent:CONTAINER.view(L.container_name),group:$pxi.get_group("MENULAYER"),list:i,text:n})},1)}))}(e)}),w(!0)})())}if(!L.game_pause&&L.gameplaying){let t;c(L.balls,2).forEach(e=>{let i=$pxi.sort_list_by_object_key(e.map(e=>({body:e,posy:e.getPosition().y})),"posy").reverse(),n=i[0].body,o=R.pixipos_planckpos(planck.Vec2(0,$pxi.ccc(1728)-$pxi.ccc(L.bottom_height))).y,a=n.getFixtureList().getShape().getRadius(),l=i[0].posy+a;l>o&&(l=o),a/10>o-l&&i.forEach(e=>{e.posy-a<=(top_area_height()+$pxi.ccc(32)/2)/R.worldScale?(void 0===t&&(t=[]),t.push(e.body),g(e.body)):d(e.body)})}),L.in_danger=void 0!==t,void 0===t?L.danger_time=0:(void 0===L.danger_time&&(L.danger_time=0),L.danger_time+=e),L.danger_time>L.timeout&&function(){{S().getNextgoal().title.getNode().visible=!1,S().getNextgoal().value.getNode().visible=!1,L.checker_pointer.getList().forEach(e=>{L.checker_pointer.setchecker(e,0),L.checker_pointer.setactive(e,!1)}),L.gameplaying=!1,a(!1),b(),L.balls.forEach(e=>{if(d(e),e.getUserData().item_kind){let t=e.getUserData().item_kind.item_element;t.parent&&t.parent.removeChild(t)}e.getUserData().pixi_element.children[0].texture=z[e.getUserData().ballkind].texture});let e=$pxi.image_sprite(xk.res_list.gameover);e.x=($pxi.ccc(1080)-e.width)/2,e.y=$pxi.ccc(1728)-(e.x+$pxi.ccc(e.texture.height)),e.parentGroup=$pxi.get_group("GAMEOVERBANNER"),CONTAINER.view(L.container_name).addChild(e);{let e=$pxi.image_sprite(xk.res_list.white);e.parentGroup=$pxi.get_group("GAMEOVERBANNER"),e.width=$pxi.ccc(1080)/1,e.height=$pxi.ccc(1728)/1,e.x=$pxi.ccc(0),e.y=$pxi.ccc(0),e.alpha=0,CONTAINER.view(L.container_name).addChild(e),commonutil.animation((t,i)=>{e.alpha=.8*(1-t),i&&e.parent.removeChild(e)},2500,constvalue.easing.easeOutQuad)}{let t=$pxi.get_group("MENULAYER"),i=S();_(!0),i.move_to_center(()=>{let e=n();vs.set("goldset",(function(t){e&&(e.destroy(t,"어디서"),e=null,vs.set("goldset",e))}))});let o=[{label:"다시하기",exec:()=>{e.parent&&(l.close(),e.parent.removeChild(e),u(null,!1,()=>{G(!0)}))}}],a=CONTAINER.view(L.container_name),l=$cpn.make_menu({disable_touchable_out:!0,bottom:$pxi.ccc(0),menu:o,group:t,parent:a,close_default_event:()=>{w(!0)}})}}}()}}});!function(){let e,n=$pxi.get_group("MENULAYER"),o=$pxi.image_sprite(xk.res_list.logo);o.y=o.height/2,o.zOrder=3,$pxi.addChild(n,o);let a=!1,l=[{label:"시작하기",exec:()=>{play_audio("audio_bom"),d();try{e.remove()}catch(e){}u(0,!0,()=>{G(!0)})}},{label:"金보유 현황",exec:()=>{if(!a){a=!0;try{e.remove()}catch(e){}i(()=>{$network.call("getuserinfo",{},{success:function(t){e=function(e,t,i){let n=t,o=I("0".repeat(String(e).length),10,n);o.x=($pxi.ccc(1080)-o.width)/2,o.y=($pxi.ccc(1728)-o.height)/2,o.y+=o.height;let a=o.height,l=o.chars[0].getNode().scale.y,r=0;o.chars.forEach((t,n)=>{t.getNode().scale.y=0,t.y=t.y-a/2,(async()=>{let c=t,d=30,h=5,g=4,_=c.y,u=Number(String(e)[n]);for(await commonutil.delay(100*n);!(s||(u++,u>=10&&(u=0),c.text=String(u),await new Promise(e=>{let t=_;commonutil.animation((i,n,o)=>{c.getNode().scale.y=l*i,c.y=t+i*(a/2),n&&e()},d,constvalue.easing.linear)}),h<=0&&(d+=10*Math.abs(h)),h<=-g));)await new Promise(e=>{let t=c.y;commonutil.animation((i,n,o)=>{c.getNode().scale.y=l*(1-i),c.y=t+i*(a/2),n&&e()},d,constvalue.easing.linear)}),c.y=_,h--;r++,r===o.chars.length&&i()})()});let s=!1;function c(){s=!0,o.chars.forEach((e,t)=>{e.destroy()})}return{remove:c}}(t.point,n,()=>{console.log("end")})},error:function(){},complete:function(){a=!1}})},(e,i)=>{let n=[{name:"취소",exe:e=>{o.remove()}},{name:"로그인",exe:n=>{o.remove(),t(e,i)}}],o=$cpn.dialogbox({...$cpn.dialogbox(),parent:CONTAINER.view(L.container_name),group:$pxi.get_group("ASKINGSAVEGOLD"),list:n,text:"현황 확인을 위해서는 로그인이 필요해요"})})}}},{label:"게임에 대해",exec:()=>{!function(){WEBCOMPONENT.visible(!0);{let e=$wcm.ccc(27),t=$wcm.ccc(54),i=$wcm.view();i.style.padding=e+"px",i.style.color="#fff",i.style.background="#000",i.style.top=t+"px",i.style.bottom=t+"px",i.style.left=t+"px",i.style.right=t+"px",WEBCOMPONENT.view.appendChild(i);let n=document.createElement("div");n.classList.add("font_bold"),n.textContent="동물의金",i.appendChild(n);let o,a=fit_fontsize_to_pixel_scale(n,n.getBoundingClientRect().width/5,!0),l=fit_fontsize_to_pixel_scale(n,n.getBoundingClientRect().width/3,!0);{let t=document.createElement("div");t.style.height=e+"px",i.appendChild(t)}{let e=document.querySelector("#element_credit").cloneNode(!0);e.removeAttribute("id"),e.classList.add("font_light"),e.classList.remove("invisible"),e.style.fontSize=a.fontSize,e.style.overflow="auto",e.style.height=$wcm.ccc(1080)+"px",e.querySelectorAll(".terms_big_title").forEach(e=>{e.classList.add("font_light")}),e.querySelectorAll(".term_section_body").forEach(e=>{e.style.paddingLeft=$wcm.ccc(27)+"px"}),e.querySelectorAll(".term_section_sub").forEach(e=>{e.style.paddingLeft=$wcm.ccc(27)+"px"}),i.appendChild(e),o=e}{let t=document.createElement("div");t.style.height=e+"px",i.appendChild(t)}let r=[];{let e=document.createElement("div");e.classList.add("font_light"),e.textContent="확인",e.style.fontSize=l.fontSize,e.style.display="inline-block",e.style.width="100%",e.style.cursor="pointer",e.style.textAlign="center",e.style.padding=$wcm.ccc(54)+"px",e.style.boxSizing="border-box",i.appendChild(e),r.push(e),e.addEventListener("click",()=>{i.parentElement.removeChild(i),WEBCOMPONENT.visible(!1)})}let s=i.getBoundingClientRect().height-2*e-(n.getBoundingClientRect().height+r[0].getBoundingClientRect().height)-2*e;o.style.height=s.toFixed(2)+"px"}}()}}],r=n,s=r.toContainer(),c=$cpn.make_menu({disable_touchable_out:!0,bottom:$pxi.ccc(172.8),menu:l,group:r,parent:s,close_default_event:()=>{w(!0),CONTAINER.visible(L.container_name),CONTAINER.invisible(L.office_name)}});function d(){o.parent&&(c.close(),o.parent.removeChild(o))}}();function G(e){L.gameplaying=e}function M(e,t,i){let n=$pxi.get_group("GAMEOVERBANNER");{let a=new PixiText({fontFamily:"jalnan"});function o(e){commonutil.animation((t,i,n)=>{a.getNode().alpha=1-t,i&&(a.destroy(),e&&e())},500,constvalue.easing.linear)}a.text=e,a.size=$pxi.ccc(200),a.x=a.width/2+($pxi.ccc(1080)-a.width)/2,a.y=a.height/2+1.5*a.height,$pxi.addChild(n,a),a.getNode().alpha=0,(async()=>{await new Promise(e=>{commonutil.animation((t,i,n)=>{a.getNode().alpha=t,i&&e()},500,constvalue.easing.linear)}),1===i&&(await commonutil.delay(700),await new Promise(e=>{o(e)})),t(a,o)})()}{let t=new PixiText({fontFamily:"jalnan"});t.text=e,t.size=$pxi.ccc(200),t.x=t.width/2+($pxi.ccc(1080)-t.width)/2,t.y=t.height/2+1.5*t.height,$pxi.addChild(n,t);let i=t.getNode().scale.x;commonutil.animation((e,n,o)=>{t.getNode().scale.x=i+i/2*e,t.getNode().scale.y=i+i/2*e,t.getNode().alpha=1-e,n&&t.destroy()},300,constvalue.easing.linear)}}vs.set("GBODYDEV",{make_clear:M,add_new:m,make_each_string_set:I,make_combo_label:p,gv:L,loginform:t}),playground_code()}(function(){var e=function(e){var t=this;for(var i in e)t[i]=e[i];t.views=[],this.genContainer(),this.setValue(t.value)};e.prototype={remove:function(){this.remove_numbers();let e=this.getContainer();e.parent.removeChild(e)},remove_numbers:function(){let e=this;for(;e.views.length;){let t=e.views.splice(0,1)[0];t.parent.removeChild(t)}},setValue:function(e){let t=this;t.value=e,t.setSize(),t.remove_numbers();let i={};i[0]=xk.res_list.num_0,i[1]=xk.res_list.num_1,i[2]=xk.res_list.num_2,i[3]=xk.res_list.num_3,i[4]=xk.res_list.num_4,i[5]=xk.res_list.num_5,i[6]=xk.res_list.num_6,i[7]=xk.res_list.num_7,i[8]=xk.res_list.num_8,i[9]=xk.res_list.num_9,i["+"]=xk.res_list.oper_p,i["-"]=xk.res_list.oper_m,i["/"]=xk.res_list.oper_d,i.x=xk.res_list.oper_x,t.width=0,t.height=0,t.value.split("").forEach(e=>{let n=new PIXI.Sprite(i[e].texture);t.views[t.views.length]=n,this.getContainer().addChild(n),n.position.x=t.width,t.width+=n.width,t.height=n.height}),t.setSize(t.size)},getSize:function(){let e=this,t=e.getContainer();return{width:t.scale.x*e.width,height:t.scale.y*e.height}},setSize:function(e){let t=this,i=t.getContainer();i.scale.x=void 0===e?1:e/t.height,i.scale.y=void 0===e?1:e/t.height,void 0!==e&&(t.size=e)},genContainer:function(){let e=new PIXI.Sprite(xk.res_list.white.texture);this.parent.addChild(e),this.container=e},getContainer:function(){return this.container}},this.BeautifulNumber=e}).call(this);